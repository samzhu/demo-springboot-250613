spring:
  application:
    name: demo
  threads:
    virtual:
      enabled: true

management:
  observations:
    annotations:
      enabled: true # 啟用基於註解的觀測 (@Observed)
  opentelemetry:    # OpenTelemetry 資源屬性，將附加到所有遙測訊號
    resource-attributes:
      service.version: "1.0.0"
      deployment.environment: "production" # 預設為正式環境
  # Tracing 相關配置
  tracing:
    sampling:
      # 正式環境建議較低的採樣率以降低效能影響
      probability: 0.1
    baggage:
      enabled: true  # 啟用 Baggage 功能
      remote-fields: # 聲明需要跨服務傳播的業務欄位
        - book-id
      tag-fields:    # 為 Baggage 自動添加為本地 Span 的標籤 (tag)
        - book-id
      correlation:   # 將 Baggage 欄位加入到日誌的 MDC 中，方便日誌關聯
        fields:
          - book-id
  endpoints:
    web:
      exposure:
        include: "health,info,metrics,prometheus" # 正式環境只開放必要端點
  otlp:
    metrics:
      export:
        enabled: true
        url: http://localhost:4318/v1/metrics
        step: 10s # 預設匯出間隔是 1 分鐘，可以縮短以便測試
    tracing:
      export:
        enabled: true
      endpoint: http://localhost:4318/v1/traces
    logging:
      export:
        enabled: true
      endpoint: http://localhost:4318/v1/logs
      
server:
  shutdown: graceful
  error:
    include-message: never # 正式環境不暴露詳細錯誤訊息
    include-binding-errors: never

logging:
  structured:
    format:
      file: logstash
  level:
    root: info # 正式環境使用 info 等級
    com.example.demo: info



